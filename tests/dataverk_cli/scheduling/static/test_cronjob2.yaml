apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: package_name
  namespace: dataverk
spec:
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - image: mitt.image.endpoint.no:1234/package_name
            name: package_name-cronjob
            volumeMounts:
            - mountPath: /
              name: vault-secrets
          initContainers:
          - env:
            - name: VKS_VAULT_ADDR
              value: https://vault.auth.uri.com
            - name: VKS_AUTH_PATH
              value: /path/to/auth
            - name: VKS_KV_PATH
              value: /path/to/kv
            - name: VKS_VAULT_ROLE
              value: package_name
            - name: VKS_SECRET_DEST_PATH
              value: /
            image: navikt/vks:24
            name: vks
            volumeMounts:
            - mountPath: /
              name: vault-secrets
          restartPolicy: Never
          serviceAccount: package_name
          serviceAccountName: package_name
          volumes:
          - emptyDir:
              medium: Memory
            name: vault-secrets
  schedule: '* * 31 2 *'